<Window
  x:Name="window"
  x:Class="MalwarePatch.Windows.Update.UpdateWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:local="clr-namespace:MalwarePatch"
  mc:Ignorable="d"
  ResizeMode="CanMinimize"
  Title="{Binding [WindowTitle]}"
  Background="{DynamicResource Background}"
  Foreground="{DynamicResource Foreground}"
  Height="365"
  Width="506"
  WindowStartupLocation="CenterOwner"
  FontSize="16">
  <Window.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary
          Source="../../Styles/ToolButton.xaml" />
        <ResourceDictionary
          Source="../../Styles/FlatTextBox.xaml" />
      </ResourceDictionary.MergedDictionaries>
      <BooleanToVisibilityConverter
        x:Key="converter" />
    </ResourceDictionary>
  </Window.Resources>
  <Window.TaskbarItemInfo>
    <TaskbarItemInfo
      x:Name="taskbar"
      ProgressState="{Binding ProgressState}"
      ProgressValue="{Binding TaskBarProgressValue}" />
  </Window.TaskbarItemInfo>
  <WindowChrome.WindowChrome>
    <WindowChrome
      ResizeBorderThickness="0"
      CaptionHeight="0"
      GlassFrameThickness="1,0,0,0" />
  </WindowChrome.WindowChrome>
  <Border
    x:Name="borderMain"
    BorderBrush="{DynamicResource DwmColor}"
    BorderThickness="1">
    <Grid
      x:Name="gridMain">
      <Grid.RowDefinitions>
        <RowDefinition
          Height="110" />
        <RowDefinition
          Height="1*" />
      </Grid.RowDefinitions>

      <Grid
        x:Name="gridContent"
        Grid.Row="1"
        Margin="0">
        <Grid.RowDefinitions>
          <RowDefinition
            Height="0" />
          <RowDefinition
            Height="2*" />
          <RowDefinition
            Height="1*" />
          <RowDefinition
            Height="40" />
        </Grid.RowDefinitions>
        <Grid
          Margin="100,0">
          <Grid.ColumnDefinitions>
            <ColumnDefinition
              Width="Auto" />
            <ColumnDefinition />
          </Grid.ColumnDefinitions>
          <TextBlock
            x:Name="textProxyLabel"
            HorizontalAlignment="Right"
            TextWrapping="Wrap"
            Margin="0,0,0,1.5"
            Text="{Binding [TextProxyLabel]}"
            VerticalAlignment="Center"
            FontSize="16"
            Foreground="{DynamicResource Foreground}" />
          <TextBox
            Tag="{Binding [TextProxyPlaceholder]}"
            x:Name="textProxy"
            Height="30"
            Grid.Column="1"
            Margin="10,0,40,0"
            Text="{Binding TextProxy, Mode=TwoWay}"
            IsEnabled="{Binding IsProxyEditable}"
            MaxWidth="500">
            <!--<TextBox.Effect>
            <DropShadowEffect
              ShadowDepth="0"
              BlurRadius="10"
              Opacity="0.3" />
          </TextBox.Effect>-->
          </TextBox>
        </Grid>
        <Border
          VerticalAlignment="Stretch"
          HorizontalAlignment="Stretch"
          Grid.Row="1"
          Grid.Column="0"
          Margin="30,10">
          <TextBlock
            x:Name="textStatus"
            Text="{Binding TextStatus}"
            Height="Auto"
            Width="Auto"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            TextWrapping="Wrap"
            Foreground="{DynamicResource Foreground}" />
        </Border>
        <StackPanel
          x:Name="stackProgress"
          Grid.Row="2"
          Grid.Column="0"
          Margin="20,10">
          <TextBlock
            Visibility="{Binding ElementName=progress, Path=Visibility}"
            Text="{Binding ProgressText}"
            HorizontalAlignment="Center"
            FontSize="12"
            x:Name="textProgress"
            Foreground="{DynamicResource Foreground}" />
          <ProgressBar
            x:Name="progress"
            Height="2"
            SnapsToDevicePixels="True"
            Visibility="{Binding ShowProgressBar,Mode=TwoWay,Converter={StaticResource converter}}"
            Minimum="0"
            Maximum="100"
            Value="0"
            Margin="40,20"
            MaxWidth="500"
            BorderThickness="0"
            Background="{DynamicResource ProgressBackground}"
            Foreground="{DynamicResource ProgressForeground}">
          </ProgressBar>
        </StackPanel>
        <StackPanel
          Grid.Row="3"
          Background="{DynamicResource ToolbarBackground}"
          Orientation="Horizontal"
          Height="40"
          Width="Auto">
          <Button
            x:Name="buttonRetry"
            Style="{StaticResource ToolButton}"
            Foreground="{DynamicResource Foreground}"
            Width="168"
            Height="40"
            IsEnabled="{Binding IsCheckUpdateEnabled}"
            Command="{Binding CheckUpdateCommand}">
            <StackPanel
              Orientation="Horizontal">
              <ContentControl
                Margin="0,0,12,0"
                VerticalAlignment="Center"
                Content="{StaticResource Retry}" />
              <TextBlock
                Text="{Binding [ButtonRetry]}"
                VerticalAlignment="Center"
                FontSize="13" />
            </StackPanel>
          </Button>
          <Button
            x:Name="buttonDownload"
            Command="{Binding DownloadCommand}"
            IsEnabled="{Binding IsDownloadEnabled}"
            Style="{StaticResource ToolButton}"
            Foreground="{DynamicResource Foreground}"
            Width="168"
            Height="40">
            <StackPanel
              Orientation="Horizontal">
              <ContentControl
                Margin="0,0,12,0"
                VerticalAlignment="Center"
                Content="{StaticResource Download}" />
              <TextBlock
                Text="{Binding [ButtonDownload]}"
                VerticalAlignment="Center"
                FontSize="13" />
            </StackPanel>
          </Button>
          <Button
            x:Name="buttonRestart"
            Style="{StaticResource ToolButton}"
            Foreground="{DynamicResource Foreground}"
            Width="168"
            Height="40"
            Command="{Binding RestartCommand}"
            IsEnabled="{Binding IsDownloadComplete}">
            <StackPanel
              Orientation="Horizontal">
              <ContentControl
                Margin="0,0,12,0"
                VerticalAlignment="Center"
                Content="{StaticResource Restart}" />
              <TextBlock
                Text="{Binding [ButtonRestart]}"
                VerticalAlignment="Center"
                FontSize="13" />
            </StackPanel>
          </Button>

        </StackPanel>
      </Grid>
      <Border
        x:Name="borderHeader"
        VerticalAlignment="Stretch"
        Grid.Row="0"
        HorizontalAlignment="Stretch"
        Margin="0"
        Background="{DynamicResource TitleBarBackground}">
        <TextBlock
          x:Name="textTitle"
          TextWrapping="NoWrap"
          Text="{Binding TextTitle}"
          FontSize="36"
          VerticalAlignment="Center"
          HorizontalAlignment="Center" />
      </Border>

      <Button
        x:Name="buttonDebug"
        Style="{StaticResource ToolButton}"
        Content="Debug Test"
        HorizontalAlignment="Right"
        VerticalAlignment="Top"
        Width="105"
        Height="30"
        Margin="0,40,43,0"
        Foreground="{DynamicResource Foreground}"
        FontSize="12"
        Visibility="Collapsed" />
      <Button
        x:Name="buttonMinimize"
        Content="{StaticResource Minimize}"
        Style="{StaticResource ToolButton}"
        Width="46"
        Height="28"
        HorizontalAlignment="Right"
        VerticalAlignment="Top"
        Margin="0,0,46,0" />
      <Button
        x:Name="buttonClose"
        Content="{StaticResource Close}"
        Style="{StaticResource ToolButton}"
        Width="46"
        Height="28"
        HorizontalAlignment="Right"
        VerticalAlignment="Top"
        Margin="0,0,0,0" />
      <TextBlock
        x:Name="textWindowTitle"
        HorizontalAlignment="Left"
        VerticalAlignment="Top"
        Margin="12,6,0,0"
        Foreground="{DynamicResource TitleBarForeground}"
        FontSize="12"
        Text="{Binding [WindowTitle]}" />
    </Grid>
  </Border>
  
</Window>